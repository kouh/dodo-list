<link rel="import" href="bower_components/polymer/polymer.html">
<dom-module id="dodo-list">
  <style>
    :host{
      display: block;
    }
    *{
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    #list{
      list-style: none;
    }

    #list li{
      display: flex;
      align-items: center;
      padding: 0.2em 0.5em;
    }

    .task-done{
      flex: 1;
    }
    .task-name{
      flex: 11;
      border: none;
      resize: none;
      height: auto;
    }

    .task-name:focus{
      outline: none;
    }

    .selected{
      box-shadow: 0px 0px 0px 1px #ff0000 ;
    }
  </style>
  <template>
    <ul id="list">
      <template is="dom-repeat" items="{{ tasks }}">
        <li class="task">
          <input type="checkbox" class="task-done" disabled="{{!item.started}}" checked="{{item.done::change}}">
          <input class="task-name" maxlength="30" value="{{item.name::input}}">
        </li>
      </template>
    </ul>
  </template>
</dom-module>

<script>
  DoDoList = Polymer({
    is: "dodo-list",
    ready: function(){
      this.tasks = [];
      console.log('ready');

      this.$.list.addEventListener('click', function(e){
        Array.prototype.forEach.call(this.children, function(li){
          li.classList.remove('selected');
        });
        e.target.closest('li').classList.add('selected');
      });
    },
    factoryImpl: function(tasks){
      this.tasks = tasks;
      console.log(this.tasks);
      this.selected = tasks[0];
    },
    
    properties: {
      selected:{
        type: Object,
        value: null,
      }
    },

    add: function(taskName){
      taskName = taskName || 'new task';
      this.push('tasks', {
        done: false,
        name: taskName,
        started: false,
      });
    }
  });
</script>
